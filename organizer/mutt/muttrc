# Accounts
set my_acc_private = ~/.config/mutt/accounts/private
set my_acc_brainbot = ~/.config/mutt/accounts/brainbot

source $my_acc_private

macro index <f2> "<sync-mailbox><refresh><enter-command>source $my_acc_private<enter><change-folder>!<enter>"
macro index <f3> "<sync-mailbox><refresh><enter-command>source $my_acc_brainbot<enter><change-folder>!<enter>"


# Send Mails
set sendmail = "msmtp -a $my_acc_mbsync"
set realname = "Thore Weilbier"
set sendmail = "/usr/bin/msmtp --file /home/thore/.config/msmtp/config -a private"
set abort_noattach = ask-yes
set abort_noattach_regex = "\<attach(|ed|ments?)|Anhang|AnhÃ¤nge\\>"
set use_from
set edit_headers
set fast_reply
set include
set forward_format = "Fwd: %s"

# Sourcing
source ~/.config/mutt/colors

# Charset
set charset = "utf-8"
set send_charset = "utf-8"
set assumed_charset = "utf-8"

# Index Pane
set sort = threads
set sort_aux = "last-date-received"
set date_format = "%H:%M %a %d.%m.%Y"
set index_format = "%-20.20F  %?M? [%M]? %s%GA%g%* (%D)"
set collapse_all
unset collapse_unread
set uncollapse_jump

# Pager Pane
ignore *
unignore from to subject date cc bcc
set pager_index_lines = 15

## Autoviews
auto_view text/html
auto_view application/ics

# Sidebar
set sidebar_visible
set mail_check_stats
set sidebar_width = 25
set sidebar_divider_char = '  '
set sidebar_format = "%-7.7B %?F?[%F]?%* %N/%-5S"
set sidebar_short_path
set sidebar_component_depth = 1
set sidebar_delim_chars = '/'
bind index,pager \CP sidebar-prev
bind index,pager \CN sidebar-next
bind index,pager \CO sidebar-open

# More Bindings
## Index & Pager
bind index,pager <f8> help
bind index,pager \C\<Return> entire-thread
bind index,pager r group-reply

## Index
bind index G last-entry
bind index \Cu half-up
bind index \Cd half-down
bind index ? search-reverse
bind index N search-opposite
bind index u toggle-new
bind index z collapse-thread
macro index <f9> "!mbsync -c $XDG_CONFIG_HOME/isync/mbsyncrc $my_acc_mbsync && notmuch new<enter>" "Syncronise account $my_acc_mbsync"

## Pager
bind pager g top
bind pager G bottom
bind pager k previous-line
bind pager j next-line
bind pager \Cu half-up
bind pager \Cd half-down
bind pager \Ck previous-entry
bind pager \Cj next-entry
macro pager A "<pipe-message>ripmime -i - -d "
macro pager U "<pipe-message> urlscan --compact<Enter>"

# Notmuch
set nm_default_uri = "notmuch:///home/thore/Mail"
tag-transforms "attachment" "@"
tag-formats "attachment" "GA"
set hidden_tags = ""
macro index <f10> "<sync-mailbox><shell-escape>notmuch new<enter>" "Update notmuch database"
bind index,pager \\ vfolder-from-query
bind index,pager \Cv sidebar-toggle-virtual
# startup-hook 'exec mbsync -a && notmuch new'
# shutdown-hook 'push "<shell-escape>notmuch new<enter>"'

# Contacts
set query_command = "khard email --parsable '%s'"
bind editor <Tab> complete-query
bind editor ^T complete
bind query k previous-line
bind query j next-line

# Caching
set header_cache = ~/.cache/mutt/header
set header_cache_backend = "gdbm"

# Behavior
unset wait_key
unset mark_old
unset menu_move_off
set menu_scroll

# MISC
unset markers

# vim: filetype=neomuttrc
